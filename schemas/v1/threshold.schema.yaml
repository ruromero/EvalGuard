$schema: http://json-schema.org/draft/2020-12/schema
$id: https://github.com/evalguard/evalguard/schemas/v1/threshold.schema.yaml
title: Threshold
description: Schema to define interpretation thresholds for metric scores within a task context.
type: object
properties:
  task:
    type: string
    description: Task ID to which these thresholds apply.
  thresholds:
    type: object
    description: Mapping from metric IDs to arrays of threshold ranges and labels.
    patternProperties:
      "^.+$":
        type: array
        description: Array of threshold ranges for a metric
        items:
          $ref: "#/definitions/ThresholdRangeItem"
required:
  - task
  - thresholds
additionalProperties: false
definitions:
  ThresholdRangeItem:
    type: object
    description: A threshold range with label and optional min/max values
    properties:
      impact:
        type: string
        enum: [no_measurable, very_low, low, moderate, high, severe]
        description: |
          Security impact level of the threshold.
          
          - `no_measurable`: No measurable security risk
          - `very_low`: Very low security risk
          - `low`: Minimal security risk
          - `moderate`: Moderate security risk
          - `high`: Significant security risk
          - `severe`: Critical security risk
      min:
        type: number
        description: Inclusive minimum value for this range. Optional if only max is set.
      max:
        type: number
        description: Exclusive maximum value for this range. Optional if only min is set.
      interpretation:
        type: string
        description: Optional detailed explanation of what this threshold range means.
    required:
      - impact
    additionalProperties: false
    anyOf:
      - required:
          - min
      - required:
          - max 